<?xml version="1.0"?>
<ruleset name="Etch Fusion Suite">
    <description>WordPress Coding Standards for Etch Fusion Suite Plugin</description>

    <!-- Check all PHP files -->
    <arg name="extensions" value="php"/>
    
    <!-- Show progress and use colors -->
    <arg value="ps"/>
    <arg name="colors"/>
    
    <!-- Parallel processing -->
    <arg name="parallel" value="8"/>
    
    <!-- Encoding -->
    <arg name="encoding" value="utf-8"/>

    <!-- What to scan -->
    <file>./includes</file>
    <file>./assets</file>
    <file>./etch-fusion-suite.php</file>

    <!-- Exclude patterns -->
    <exclude-pattern>vendor/*</exclude-pattern>
    <exclude-pattern>*/vendor/*</exclude-pattern>
    <exclude-pattern>node_modules/*</exclude-pattern>
    <exclude-pattern>*/node_modules/*</exclude-pattern>
    <exclude-pattern>tests/*</exclude-pattern>
    <exclude-pattern>*/tests/*</exclude-pattern>
    <exclude-pattern>phpunit.xml.dist</exclude-pattern>
    <exclude-pattern>.wp-env/*</exclude-pattern>
    <exclude-pattern>*/.wp-env/*</exclude-pattern>
    <exclude-pattern>scripts/*</exclude-pattern>
    <exclude-pattern>*/scripts/*</exclude-pattern>
    <exclude-pattern>*.min.js</exclude-pattern>
    <exclude-pattern>*.min.css</exclude-pattern>

    <!-- Use WordPress Core ruleset as baseline -->
    <rule ref="WordPress-Core">
        <!-- Allow short array syntax -->
        <exclude name="Generic.Arrays.DisallowShortArraySyntax"/>

        <!-- Disable strict file naming (we use PSR-4) -->
        <exclude name="WordPress.Files.FileName.InvalidClassFileName"/>
        <exclude name="WordPress.Files.FileName.NotHyphenatedLowercase"/>
    </rule>

    <!-- Text domain -->
    <rule ref="WordPress.WP.I18n">
        <properties>
            <property name="text_domain" type="array">
                <element value="etch-fusion-suite"/>
                <element value="bricks-etch-migration"/>
            </property>
        </properties>
    </rule>

    <!-- Prefix for global namespace -->
    <rule ref="WordPress.NamingConventions.PrefixAllGlobals" type="warning">
        <properties>
            <property name="prefixes" type="array">
                <element value="efs"/>
                <element value="efs_security_headers"/>
                <element value="efs_cors"/>
                <element value="etch_fusion_suite"/>
                <element value="EFS"/>
                <element value="EtchFusion"/>
                <element value="EtchFusionSuite"/>
                <element value="b2e"/>
                <element value="B2E"/>
                <element value="Bricks2Etch"/>
            </property>
        </properties>
        <exclude name="WordPress.NamingConventions.PrefixAllGlobals.ShortPrefixPassed"/>
    </rule>

    <!-- Security: Escape output -->
    <rule ref="WordPress.Security.EscapeOutput"/>
    
    <!-- Security: Validate and sanitize input -->
    <rule ref="WordPress.Security.ValidatedSanitizedInput"/>
    
    <!-- Security: Nonce verification -->
    <rule ref="WordPress.Security.NonceVerification"/>
</ruleset>
